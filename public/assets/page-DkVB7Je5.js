import{x as P,r as p,j as e,S as L,l as z,B as g,m as B,n as M,o as O,p as q,q as V,s as G,L as v,t as S,h as C,y as H,g as A,z as K,A as b,C as U}from"./index-LIwVw57E.js";import{C as R,a as Q,b as W,e as $,d as J}from"./card-fA9T2TmR.js";import{S as X,a as Y}from"./switch-DbW6hBRZ.js";import{l as Z,m as ee,F as se,n as y,o as N,p as D,q as ae,t as E,v as re,w as te,x as ne,z as ie,y as oe,A as ce,a as le,T as de,b as xe,c as he,d as me,e as ue,f as je,g as pe,u as ge,C as fe,G as ve,h as Se,i as w,D as Ce,r as be,j as ye,S as Ne,s as De,K as Ee,P as we,k as Ae}from"./zod-DeSQqOrt.js";import{I}from"./input-9Q9Ttv5E.js";import{P as F,S as Ie,a as Fe}from"./scroll-area-DPj461DN.js";import{S as ke}from"./skeleton-Dv2j4Awu.js";import"./label-BvTTDt91.js";const Te=ne({name:oe({required_error:"Name is required."}).min(1,{message:"Name must be at least 1 character long."}),price:ie.number().min(0)});function _e(){const[r,{isLoading:s}]=P(),[t,c]=p.useState(!1),a=Z({mode:"onChange",reValidateMode:"onChange",resolver:te(Te),defaultValues:{name:"",price:0}});function i(o){r(o).unwrap().then(()=>{S.success("Service created"),c(!1),a.reset()}).catch(l=>{C(l)})}return e.jsxs(L,{open:t,onOpenChange:c,children:[e.jsx(z,{asChild:!0,children:e.jsxs(g,{children:[e.jsx(ee,{}),"Create service"]})}),e.jsxs(B,{children:[e.jsxs(M,{children:[e.jsx(O,{children:"Add extra service"}),e.jsx(q,{className:"sr-only"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:e.jsx(se,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(i),className:"space-y-6",children:[e.jsx(y,{control:a.control,name:"name",render:({field:o})=>e.jsxs(N,{children:[e.jsx(D,{children:"Name (required)"}),e.jsx(ae,{children:"Name of the extra service, visible to customers."}),e.jsx(E,{children:e.jsx(I,{...o,autoComplete:"off"})}),e.jsx(re,{})]})}),e.jsx(y,{control:a.control,name:"price",render:({field:o})=>e.jsxs(N,{children:[e.jsx(D,{children:"Price"}),e.jsx(E,{children:e.jsx(F,{name:"price",value:o.value,onValueChange:o.onChange})})]})})]})})}),e.jsxs(V,{children:[e.jsx(G,{asChild:!0,children:e.jsx(g,{type:"button",variant:"outline",className:"w-full",children:"Cancel"})}),e.jsx(v,{type:"button",loading:s,disabled:s,onClick:a.handleSubmit(i),className:"w-full",children:"Add service"})]})]})]})}function Pe({extraService:r}){const[s,t]=p.useState(!1),[c,{isLoading:a}]=H();return e.jsxs(ce,{open:s,onOpenChange:t,children:[e.jsx(le,{asChild:!0,children:e.jsx(g,{variant:"outline",size:"icon",className:"hover:text-destructive",children:e.jsx(de,{})})}),e.jsxs(xe,{children:[e.jsxs(he,{children:[e.jsx(me,{children:"Delete extra service?"}),e.jsxs(ue,{children:["This will delete ",e.jsxs("b",{children:[r.name,"."]})]})]}),e.jsxs(je,{children:[e.jsx(pe,{children:"Cancel"}),e.jsx(v,{type:"button",loading:a,disabled:a,className:"mt-2 sm:mt-0",variant:"destructive",onClick:()=>{c({id:r.id}).unwrap().then(()=>{S.success("Extra service deleted"),t(!1)}).catch(i=>{C(i)})},children:"Delete"})]})]})]})}function Le({id:r,item:s,onChange:t}){const{attributes:c,listeners:a,setNodeRef:i,transform:o,transition:l,isDragging:h}=ge({id:r}),f={transform:fe.Transform.toString(o),transition:l,zIndex:h?1e3:"auto",position:h?"relative":"static"};return e.jsxs("div",{ref:i,style:f,className:A("grid grid-cols-[max-content_3fr_1fr_1fr_1fr] items-center gap-4 p-2",{"bg-background shadow-lg":h}),children:[e.jsx(g,{size:"icon",variant:"ghost",className:"flex min-w-6 cursor-grab",...c,...a,children:e.jsx(ve,{})}),e.jsx(I,{name:s.name,value:s.name,onChange:d=>{const n=d.target.value;t(s.id,{name:n})}}),e.jsx(F,{id:s.id.toString(),value:s.price,onValueChange:d=>{t(s.id,{price:d})}}),e.jsx(X,{checked:s.enabled,onCheckedChange:d=>{t(s.id,{enabled:d})}}),e.jsx("div",{className:"flex justify-end",children:e.jsx(Pe,{extraService:s})})]})}function ze({extraServices:r,isLoading:s}){const[t,{isLoading:c}]=K(),[a,i]=p.useState([]),[o,l]=p.useState(!1),h=Se(w(we),w(Ee,{coordinateGetter:De}));p.useEffect(()=>{r&&i(r)},[r]);function f(n){const{active:x,over:m}=n;if(m&&x.id!==m.id){const u=a.findIndex(j=>j.id===x.id),k=a.findIndex(j=>j.id===m.id),T=Ae(a,u,k).map((j,_)=>({...j,index:_}));i(T),l(!0)}}function d(n,x){i(m=>m.map(u=>u.id===n?{...u,...x}:u)),l(!0)}return e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs(Ie,{className:"w-full",children:[e.jsxs("div",{className:"mb-4 grid grid-cols-[max-content_3fr_1fr_1fr_1fr] items-center gap-4 text-sm font-medium text-muted-foreground",children:[e.jsx("p",{className:"size-9"}),e.jsx("p",{children:"Service name"}),e.jsx("p",{children:"Service cost, $"}),e.jsx("p",{children:"Enable"}),e.jsx("p",{})]}),e.jsx(b,{}),s&&e.jsx("div",{className:"space-y-2 pt-4",children:Array.from({length:5}).map((n,x)=>e.jsx(ke,{className:"h-13 w-full"},x))}),e.jsx(Ce,{sensors:h,collisionDetection:ye,onDragEnd:f,modifiers:[be],children:e.jsx(Ne,{items:a,children:e.jsx("div",{className:"pt-4 min-w-[700px] space-y-2",children:a.map(n=>e.jsx(Le,{id:n.id,item:n,onChange:d},n.id))})})}),e.jsx(Fe,{orientation:"horizontal"})]}),e.jsx(b,{}),e.jsxs("div",{className:A("flex transition-opacity gap-3 duration-500 justify-end",{"invisible opacity-0":!o,"visible opacity-100":o}),children:[e.jsx(g,{type:"button",variant:"outline",onClick:()=>{i(r),l(!1)},children:"Cancel"}),e.jsx(v,{type:"button",disabled:c,loading:c,onClick:()=>{t({extra_services:a}).unwrap().then(()=>{S.success("Changes saved"),l(!1)}).catch(n=>{C(n)})},children:"Save changes"})]})]})}function Be(){const{data:r,isLoading:s,isError:t}=U();return e.jsx(Y,{children:e.jsxs(R,{className:"max-w-4xl",children:[e.jsxs(Q,{children:[e.jsx(W,{children:"Extra Services"}),e.jsx($,{children:e.jsx(_e,{})})]}),e.jsxs(J,{children:[t&&e.jsx("div",{children:e.jsx("p",{className:"text-muted-foreground text-center",children:"Failed to fetch services"})}),e.jsx(ze,{extraServices:r??[],isLoading:s})]})]})})}const Qe=Be;export{Qe as Component};
