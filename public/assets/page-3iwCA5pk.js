import{PhoneInput as e,isValidPhoneNumber as t}from"./phone-input-DV5b9ZTz.js";import"./chevron-left-zJdJqyR0.js";import{Button as n,Form as r,FormControl as i,FormField as a,FormItem as o,FormLabel as s,FormMessage as c,Input as l,LoadingButton as u,Spinner as d,__toESM as f,a as p,cn as m,formatPhone as h,instanceOfType as g,objectType as _,require_jsx_runtime as v,require_react as y,stringType as b,toast as x,useBulkUpdateSettingsMutation as S,useForm as C,useGetSettingsQuery as w,useUpdateLogoMutation as T}from"./index-BpPvn16n.js";import{Card as E,CardContent as D,CardFooter as O,CardHeader as k,CardTitle as A}from"./card-D6e0mOnd.js";import{SettingPageWrapper as j}from"./setting-page-wrapper-B7I8Q1ot.js";var M=f(y()),N=f(v());const P=_({image:g(File).nullable()});function F(e){let t=e.target.files&&e.target.files[0],n=t?URL.createObjectURL(t):``;return{file:t,displayUrl:n}}function I({data:e}){let[t,{isLoading:c}]=T(),[d,f]=(0,M.useState)(null),p=C({defaultValues:{image:null}});async function h(e){await t({image:e.image}).unwrap(),x.success(`Changes saved`),p.reset()}return(0,M.useEffect)(()=>{e&&f(e.company_logo)},[e]),(0,N.jsxs)(E,{className:`max-w-xl`,children:[(0,N.jsx)(k,{children:(0,N.jsx)(A,{children:`Branding`})}),(0,N.jsx)(D,{children:(0,N.jsx)(r,{...p,children:(0,N.jsxs)(`form`,{onSubmit:p.handleSubmit(h),className:`space-y-6`,children:[(0,N.jsx)(a,{control:p.control,name:`image`,render:({field:{value:e,onChange:t,...n}})=>(0,N.jsxs)(o,{children:[(0,N.jsx)(s,{children:`Logo`}),(0,N.jsx)(i,{children:(0,N.jsx)(l,{...n,placeholder:`Image`,type:`file`,accept:`image/png, image/jpeg`,multiple:!1,onChange:e=>{let{file:n,displayUrl:r}=F(e);f(r),t(n)}})})]})}),(0,N.jsx)(`div`,{className:`flex justify-center items-center`,children:d&&(0,N.jsx)(`div`,{className:`relative size-40 p-1 rounded-md border-2 border-dashed`,children:(0,N.jsx)(`img`,{src:d,alt:`Company logo`,className:`h-full w-full rounded-md object-contain`})})})]})})}),(0,N.jsx)(O,{className:`justify-end border-t`,children:(0,N.jsxs)(`div`,{className:m(`flex transition-opacity gap-3 duration-500`,{"invisible opacity-0":!p.formState.isDirty,"visible opacity-100":p.formState.isDirty}),children:[(0,N.jsx)(n,{type:`button`,variant:`outline`,onClick:()=>{f(e?.company_logo||null),p.reset()},children:`Cancel`}),(0,N.jsx)(u,{type:`button`,disabled:c,loading:c,onClick:()=>{p.handleSubmit(h)()},children:`Save changes`})]})})]})}const L=_({company_name:b(),company_address:b(),company_phone:b().refine(e=>t(e,`US`),{message:`Invalid phone number`}),company_email:b().email(),company_website:b()});function R({data:t}){let[d,{isLoading:f}]=S(),g=C({resolver:p(L),defaultValues:{company_name:t.company_name??``,company_address:t.company_address??``,company_phone:t.company_phone??``,company_email:t.company_email??``,company_website:t.company_website??``}});async function _(e){let t=await d({data:e}).unwrap();t&&(x.success(`Changes saved`),g.reset({...t}))}return(0,N.jsxs)(E,{className:`max-w-xl`,children:[(0,N.jsx)(k,{children:(0,N.jsx)(A,{children:`Company Information`})}),(0,N.jsx)(D,{children:(0,N.jsx)(r,{...g,children:(0,N.jsxs)(`form`,{onSubmit:g.handleSubmit(_),className:`space-y-6`,children:[(0,N.jsx)(a,{control:g.control,name:`company_name`,render:({field:e})=>(0,N.jsxs)(o,{children:[(0,N.jsx)(s,{children:`Company name`}),(0,N.jsx)(i,{children:(0,N.jsx)(l,{...e,autoComplete:`off`})}),(0,N.jsx)(c,{})]})}),(0,N.jsx)(a,{control:g.control,name:`company_address`,render:({field:e})=>(0,N.jsxs)(o,{children:[(0,N.jsx)(s,{children:`Company address`}),(0,N.jsx)(i,{children:(0,N.jsx)(l,{...e,autoComplete:`off`})}),(0,N.jsx)(c,{})]})}),(0,N.jsx)(a,{control:g.control,name:`company_phone`,render:({field:t})=>(0,N.jsxs)(o,{children:[(0,N.jsx)(s,{children:`Company phone`}),(0,N.jsx)(i,{children:(0,N.jsx)(e,{...t,value:h(t.value??``),handleValueChange:t.onChange})}),(0,N.jsx)(c,{})]})}),(0,N.jsx)(a,{control:g.control,name:`company_email`,render:({field:e})=>(0,N.jsxs)(o,{children:[(0,N.jsx)(s,{children:`Company email`}),(0,N.jsx)(i,{children:(0,N.jsx)(l,{...e,autoComplete:`off`})}),(0,N.jsx)(c,{})]})}),(0,N.jsx)(a,{control:g.control,name:`company_website`,render:({field:e})=>(0,N.jsxs)(o,{children:[(0,N.jsx)(s,{children:`Company website`}),(0,N.jsx)(i,{children:(0,N.jsx)(l,{...e,autoComplete:`off`})}),(0,N.jsx)(c,{})]})})]})})}),(0,N.jsx)(O,{className:`justify-end border-t`,children:(0,N.jsxs)(`div`,{className:m(`flex transition-opacity gap-3 duration-500`,{"invisible opacity-0":!g.formState.isDirty,"visible opacity-100":g.formState.isDirty}),children:[(0,N.jsx)(n,{type:`button`,variant:`outline`,onClick:()=>g.reset(),children:`Cancel`}),(0,N.jsx)(u,{type:`button`,disabled:f,loading:f,onClick:()=>{g.handleSubmit(_)()},children:`Save changes`})]})})]})}function z(){let{data:e,isLoading:t}=w();return(0,N.jsx)(j,{children:t?(0,N.jsx)(`div`,{className:`flex h-96 max-w-xl items-center justify-center`,children:(0,N.jsx)(d,{})}):(0,N.jsxs)(`div`,{className:`space-y-4`,children:[(0,N.jsx)(R,{data:e}),(0,N.jsx)(I,{data:e})]})})}const B=z;export{B as Component};