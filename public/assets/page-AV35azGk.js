import{PenLine as e}from"./pen-line-Cche-2Y9.js";import{Button as t,Card as n,CardContent as r,CardFooter as i,CardHeader as a,CardTitle as o,Input as s,LoadingButton as c,NumericInput as l,ScrollArea as u,ScrollBar as d,Separator as f,Skeleton as p,Switch as m,__toESM as h,cn as g,formatCentsToDollarsString as _,handleApiError as v,hexToRgb as y,require_jsx_runtime as b,require_react as x,toast as S,useBulkUpdateRatesMutation as C,useGetRatesQuery as w}from"./index-OmLcTgDE.js";import{SettingPageWrapper as T}from"./setting-page-wrapper-DsxRRjvs.js";var E=h(x()),D=h(b());const O=`grid grid-cols-[2fr_1fr_1fr_1fr_1fr_1fr_1fr_1fr] items-center gap-4 px-1 text-sm font-medium`;function k(){let{data:p,isLoading:h}=w(),[b,{isLoading:x}]=C(),[k,A]=(0,E.useState)([]),[M,N]=(0,E.useState)(!1),[P,F]=(0,E.useState)(null);(0,E.useEffect)(()=>{p&&A(p)},[p]);function I(e){let t=k.map(t=>t.id===e.id?e:t);A(t),N(!0)}return(0,D.jsx)(T,{children:(0,D.jsxs)(n,{children:[(0,D.jsx)(a,{children:(0,D.jsx)(o,{children:`Rates`})}),(0,D.jsx)(r,{className:`space-y-6`,children:(0,D.jsxs)(u,{className:`w-full`,children:[(0,D.jsxs)(`div`,{className:g(`mb-4 text-muted-foreground`,O),children:[(0,D.jsx)(`p`,{children:`Name`}),(0,D.jsx)(`p`,{children:`2 movers`}),(0,D.jsx)(`p`,{children:`3 movers`}),(0,D.jsx)(`p`,{children:`4 movers`}),(0,D.jsx)(`p`,{children:`Extra mover`}),(0,D.jsx)(`p`,{children:`Extra truck`}),(0,D.jsx)(`p`,{children:`On/Off`}),(0,D.jsx)(`p`,{className:`sr-only`,children:`Actions`})]}),(0,D.jsx)(f,{}),(0,D.jsxs)(`div`,{className:`min-w-[900px] divide-y`,children:[h&&(0,D.jsx)(j,{}),k?.map((n,r)=>(0,D.jsxs)(`div`,{className:g(`py-4`,O),children:[P===r?(0,D.jsxs)(`div`,{className:`grid grid-cols-[auto_36px] gap-2`,children:[(0,D.jsx)(s,{name:`${n.name}-name`,value:n.name,onChange:e=>{I({...n,name:e.target.value})}}),(0,D.jsx)(s,{name:`${n.name}-color`,type:`color`,value:n.color,onChange:e=>{I({...n,color:e.target.value})},className:`px-[2px] py-0`})]}):(0,D.jsxs)(`span`,{className:`flex h-9 items-center gap-2 rounded-sm px-2 py-1`,style:{color:n.color,backgroundColor:`rgba(${y(n.color)}, 0.1)`},children:[n.name,(0,D.jsx)(`span`,{className:`h-2 w-2 rounded-full`,style:{backgroundColor:n.color}})]}),Object.keys(n.movers_rates).slice(0,3).map((e,t)=>{let i=n.movers_rates[e].hourly_rate;return P===r?(0,D.jsx)(l,{name:`${n.name}-${e}-${t}`,value:(i/100).toString(),min:0,max:1e4,onChange:t=>{I({...n,movers_rates:{...n.movers_rates,[e]:{...n.movers_rates[e],hourly_rate:Number(t)*100}}})}},t):(0,D.jsx)(`div`,{children:_(i)},t)}),(0,D.jsx)(`div`,{children:P===r?(0,D.jsx)(l,{name:`${n.name}-extra-mover`,value:(n.extra_mover_rate/100).toString(),min:0,max:1e4,onChange:e=>{I({...n,extra_mover_rate:Number(e)*100})}}):_(n.extra_mover_rate)}),(0,D.jsx)(`div`,{children:P===r?(0,D.jsx)(l,{name:`${n.name}-extra-truck`,value:(n.extra_truck_rate/100).toString(),min:0,max:1e4,onChange:e=>{I({...n,extra_truck_rate:Number(e)*100})}}):_(n.extra_truck_rate)}),(0,D.jsx)(m,{id:`${n.name}-enable`,checked:n.enable,disabled:r===0,onCheckedChange:e=>{I({...n,enable:e})}}),(0,D.jsx)(t,{variant:`outline`,size:`icon`,onClick:()=>{F(e=>e===r?null:r)},children:(0,D.jsx)(e,{})})]},r))]}),(0,D.jsx)(d,{orientation:`horizontal`})]})}),(0,D.jsx)(i,{className:`justify-end border-t`,children:(0,D.jsxs)(`div`,{className:g(`flex gap-3 transition-opacity duration-500`,{"invisible opacity-0":!M,"visible opacity-100":M}),children:[(0,D.jsx)(t,{type:`button`,variant:`outline`,onClick:()=>{A(p),N(!1),F(null)},children:`Cancel`}),(0,D.jsx)(c,{type:`button`,disabled:x,loading:x,onClick:()=>{b({rates:k}).unwrap().then(()=>{N(!1),F(null),S.success(`Changes saved`)}).catch(e=>{v(e)})},children:`Save changes`})]})})]})})}const A=k;function j(){return(0,D.jsx)(D.Fragment,{children:Array.from({length:5}).map((e,t)=>(0,D.jsxs)(`div`,{className:`grid grid-cols-[2fr_1fr_1fr_1fr_1fr_1fr_1fr_1fr] items-center gap-4 px-1 py-4`,children:[(0,D.jsx)(p,{className:`h-9 w-full`}),(0,D.jsx)(p,{className:`h-9 w-full`}),(0,D.jsx)(p,{className:`h-9 w-full`}),(0,D.jsx)(p,{className:`h-9 w-full`}),(0,D.jsx)(p,{className:`h-9 w-full`}),(0,D.jsx)(p,{className:`h-9 w-full`}),(0,D.jsx)(p,{className:`h-9 w-full`}),(0,D.jsx)(p,{className:`h-9 w-full`})]},t))})}export{A as Component};