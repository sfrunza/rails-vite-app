import{x as P,r as p,j as e,S as L,l as z,B as f,m as B,n as M,o as O,p as V,q,s as G,L as v,t as S,h as C,y as H,g as A,z as K,A as b,C as U}from"./index-C_aFZ-sI.js";import{C as R,a as Q,b as W,f as $,d as J}from"./card-C7HsgJYj.js";import{S as X}from"./setting-page-wrapper-DuQItZLx.js";import{u as Y,F as Z,a as y,b as N,c as D,d as ee,e as E,f as se,s as re,o as ae,h as te,g as ne}from"./zod-D7z4GATd.js";import{I}from"./input-BR6PJhv_.js";import{P as F,S as ie,a as oe}from"./scroll-area-DoUa_-4O.js";import{P as ce}from"./plus-CFsWEjeL.js";import{A as le,a as de,T as xe,b as he,c as me,d as ue,e as je,f as pe,g as fe,u as ge,C as ve,G as Se,h as Ce,i as w,D as be,r as ye,j as Ne,S as De,s as Ee,K as we,P as Ae,k as Ie}from"./alert-dialog-AabGfu8X.js";import{S as Fe}from"./switch-CZ3596Ov.js";import{S as ke}from"./skeleton-C1C9ZeBW.js";import"./label-BuvHemho.js";import"./index-BCM0odfI.js";const Te=ae({name:ne({required_error:"Name is required."}).min(1,{message:"Name must be at least 1 character long."}),price:te.number().min(0)});function _e(){const[a,{isLoading:s}]=P(),[t,c]=p.useState(!1),r=Y({mode:"onChange",reValidateMode:"onChange",resolver:re(Te),defaultValues:{name:"",price:0}});function i(o){a(o).unwrap().then(()=>{S.success("Service created"),c(!1),r.reset()}).catch(l=>{C(l)})}return e.jsxs(L,{open:t,onOpenChange:c,children:[e.jsx(z,{asChild:!0,children:e.jsxs(f,{children:[e.jsx(ce,{}),"Create service"]})}),e.jsxs(B,{children:[e.jsxs(M,{children:[e.jsx(O,{children:"Add extra service"}),e.jsx(V,{className:"sr-only"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:e.jsx(Z,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(i),className:"space-y-6",children:[e.jsx(y,{control:r.control,name:"name",render:({field:o})=>e.jsxs(N,{children:[e.jsx(D,{children:"Name (required)"}),e.jsx(ee,{children:"Name of the extra service, visible to customers."}),e.jsx(E,{children:e.jsx(I,{...o,autoComplete:"off"})}),e.jsx(se,{})]})}),e.jsx(y,{control:r.control,name:"price",render:({field:o})=>e.jsxs(N,{children:[e.jsx(D,{children:"Price"}),e.jsx(E,{children:e.jsx(F,{name:"price",value:o.value,onValueChange:o.onChange})})]})})]})})}),e.jsxs(q,{children:[e.jsx(G,{asChild:!0,children:e.jsx(f,{type:"button",variant:"outline",className:"w-full",children:"Cancel"})}),e.jsx(v,{type:"button",loading:s,disabled:s,onClick:r.handleSubmit(i),className:"w-full",children:"Add service"})]})]})]})}function Pe({extraService:a}){const[s,t]=p.useState(!1),[c,{isLoading:r}]=H();return e.jsxs(le,{open:s,onOpenChange:t,children:[e.jsx(de,{asChild:!0,children:e.jsx(f,{variant:"outline",size:"icon",className:"hover:text-destructive",children:e.jsx(xe,{})})}),e.jsxs(he,{children:[e.jsxs(me,{children:[e.jsx(ue,{children:"Delete extra service?"}),e.jsxs(je,{children:["This will delete ",e.jsxs("b",{children:[a.name,"."]})]})]}),e.jsxs(pe,{children:[e.jsx(fe,{children:"Cancel"}),e.jsx(v,{type:"button",loading:r,disabled:r,variant:"destructive",onClick:()=>{c({id:a.id}).unwrap().then(()=>{S.success("Extra service deleted"),t(!1)}).catch(i=>{C(i)})},children:"Delete"})]})]})]})}function Le({id:a,item:s,onChange:t}){const{attributes:c,listeners:r,setNodeRef:i,transform:o,transition:l,isDragging:h}=ge({id:a}),g={transform:ve.Transform.toString(o),transition:l,zIndex:h?1e3:"auto",position:h?"relative":"static"};return e.jsxs("div",{ref:i,style:g,className:A("grid grid-cols-[max-content_3fr_1fr_1fr_1fr] items-center gap-4 p-2",{"bg-background shadow-lg":h}),children:[e.jsx(f,{size:"icon",variant:"ghost",className:"flex min-w-6 cursor-grab",...c,...r,children:e.jsx(Se,{})}),e.jsx(I,{name:s.name,value:s.name,onChange:d=>{const n=d.target.value;t(s.id,{name:n})}}),e.jsx(F,{id:s.id.toString(),value:s.price,onValueChange:d=>{t(s.id,{price:d})}}),e.jsx(Fe,{checked:s.enabled,onCheckedChange:d=>{t(s.id,{enabled:d})}}),e.jsx("div",{className:"flex justify-end",children:e.jsx(Pe,{extraService:s})})]})}function ze({extraServices:a,isLoading:s}){const[t,{isLoading:c}]=K(),[r,i]=p.useState([]),[o,l]=p.useState(!1),h=Ce(w(Ae),w(we,{coordinateGetter:Ee}));p.useEffect(()=>{a&&i(a)},[a]);function g(n){const{active:x,over:m}=n;if(m&&x.id!==m.id){const u=r.findIndex(j=>j.id===x.id),k=r.findIndex(j=>j.id===m.id),T=Ie(r,u,k).map((j,_)=>({...j,index:_}));i(T),l(!0)}}function d(n,x){i(m=>m.map(u=>u.id===n?{...u,...x}:u)),l(!0)}return e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs(ie,{className:"w-full",children:[e.jsxs("div",{className:"mb-4 grid grid-cols-[max-content_3fr_1fr_1fr_1fr] items-center gap-4 text-sm font-medium text-muted-foreground",children:[e.jsx("p",{className:"size-9"}),e.jsx("p",{children:"Service name"}),e.jsx("p",{children:"Service cost, $"}),e.jsx("p",{children:"Enable"}),e.jsx("p",{})]}),e.jsx(b,{}),s&&e.jsx("div",{className:"space-y-2 pt-4",children:Array.from({length:5}).map((n,x)=>e.jsx(ke,{className:"h-13 w-full"},x))}),e.jsx(be,{sensors:h,collisionDetection:Ne,onDragEnd:g,modifiers:[ye],children:e.jsx(De,{items:r,children:e.jsx("div",{className:"pt-4 min-w-[700px] space-y-2",children:r.map(n=>e.jsx(Le,{id:n.id,item:n,onChange:d},n.id))})})}),e.jsx(oe,{orientation:"horizontal"})]}),e.jsx(b,{}),e.jsxs("div",{className:A("flex transition-opacity gap-3 duration-500 justify-end",{"invisible opacity-0":!o,"visible opacity-100":o}),children:[e.jsx(f,{type:"button",variant:"outline",onClick:()=>{i(a),l(!1)},children:"Cancel"}),e.jsx(v,{type:"button",disabled:c,loading:c,onClick:()=>{t({extra_services:r}).unwrap().then(()=>{S.success("Changes saved"),l(!1)}).catch(n=>{C(n)})},children:"Save changes"})]})]})}function Be(){const{data:a,isLoading:s,isError:t}=U();return e.jsx(X,{children:e.jsxs(R,{className:"max-w-4xl",children:[e.jsxs(Q,{children:[e.jsx(W,{children:"Extra Services"}),e.jsx($,{children:e.jsx(_e,{})})]}),e.jsxs(J,{children:[t&&e.jsx("div",{children:e.jsx("p",{className:"text-muted-foreground text-center",children:"Failed to fetch services"})}),e.jsx(ze,{extraServices:a??[],isLoading:s})]})]})})}const Xe=Be;export{Xe as Component};
