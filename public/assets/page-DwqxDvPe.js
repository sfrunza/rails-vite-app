import{$ as g,r as d,j as e,S as C,l as S,B as u,m as k,n as v,o as b,p as N,q as T,s as y,L as h,t as x,h as p,a0 as F,a1 as w,a2 as L,g as I}from"./index-Dm7BQT7l.js";import{C as _,a as A,b as E,f as P,d as q,e as B}from"./card-V1I8AuRO.js";import{S as M}from"./skeleton-Cmd4G45R.js";import{S as O}from"./setting-page-wrapper-DigH3shI.js";import{u as U,F as D,a as H,b as V,c as z,d as G,e as Q,f as R,s as W,o as $,g as J}from"./zod-C9OWJPuT.js";import{I as j}from"./input-DQgfCGN5.js";import{P as K}from"./plus-BsPJKiy_.js";import{S as X}from"./switch-COHIPXe2.js";import"./label-DlqQ0M1t.js";import"./index-C7Ze5WLN.js";const Y=$({name:J({required_error:"Name is required."}).min(1,{message:"Name must be at least 1 character long."})});function Z(){const[r,{isLoading:c}]=g(),[l,i]=d.useState(!1),s=U({mode:"onChange",reValidateMode:"onChange",resolver:W(Y),defaultValues:{name:""}});function t(a){r(a).unwrap().then(()=>{x.success("Truck created"),s.reset(),i(!1)}).catch(n=>{p(n)})}return e.jsxs(C,{open:l,onOpenChange:i,children:[e.jsx(S,{asChild:!0,children:e.jsxs(u,{children:[e.jsx(K,{}),"Create truck"]})}),e.jsxs(k,{children:[e.jsxs(v,{children:[e.jsx(b,{children:"Add truck"}),e.jsx(N,{className:"sr-only"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:e.jsx(D,{...s,children:e.jsx("form",{onSubmit:s.handleSubmit(t),className:"space-y-6",children:e.jsx(H,{control:s.control,name:"name",render:({field:a})=>e.jsxs(V,{children:[e.jsx(z,{children:"Name (required)"}),e.jsx(G,{children:"Name of the truck for internal use."}),e.jsx(Q,{children:e.jsx(j,{...a,autoComplete:"off"})}),e.jsx(R,{})]})})})})}),e.jsxs(T,{children:[e.jsx(y,{asChild:!0,children:e.jsx(u,{type:"button",variant:"outline",className:"w-full",children:"Cancel"})}),e.jsx(h,{type:"button",loading:c,disabled:c,onClick:s.handleSubmit(t),className:"w-full",children:"Add truck"})]})]})]})}function ee({items:r,setItems:c,setIsTouched:l}){function i(s,t,a){const n=r.map(o=>o.id===s.id?{...o,[t]:a}:o);c(n),l(!0)}return e.jsx("div",{className:"space-y-4",children:r==null?void 0:r.map((s,t)=>e.jsxs("div",{className:"grid grid-cols-[6rem_3rem_1fr] gap-6 items-center",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsx(F,{className:"size-5"}),e.jsxs("span",{children:["Truck ",t+1]})]}),e.jsx(X,{checked:s.is_active,onCheckedChange:a=>{i(s,"is_active",a)}}),e.jsx(j,{value:s.name,onChange:a=>{const n=a.target.value;i(s,"name",n)}})]},s.id))})}function se(){const{data:r,isLoading:c,isError:l}=w(),[i,{isLoading:s}]=L(),[t,a]=d.useState([]),[n,o]=d.useState(!1);return d.useEffect(()=>{r&&a(r)},[r]),e.jsx(O,{children:e.jsxs(_,{className:"max-w-xl",children:[e.jsxs(A,{children:[e.jsx(E,{children:"Trucks"}),e.jsx(P,{children:e.jsx(Z,{})})]}),e.jsxs(q,{children:[l&&e.jsx("div",{children:e.jsx("p",{className:"text-muted-foreground text-center",children:"Failed to fetch trucks"})}),c&&e.jsx("div",{className:"space-y-4",children:Array.from({length:3}).map((m,f)=>e.jsx(M,{className:"h-9 w-full"},f))}),r&&e.jsx(ee,{items:t,setItems:a,setIsTouched:o})]}),e.jsx(B,{className:"justify-end border-t",children:e.jsxs("div",{className:I("flex transition-opacity duration-500 gap-3",{"invisible opacity-0":!n,"visible opacity-100":n}),children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>{a(r??[]),o(!1)},children:"Cancel"}),e.jsx(h,{type:"button",disabled:s,loading:s,onClick:()=>{i({trucks:t}).unwrap().then(()=>{o(!1),x.success("Changes saved")}).catch(m=>{p(m)})},children:"Save changes"})]})})]})})}const me=se;export{me as Component};
