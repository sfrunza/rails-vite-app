import{Button as e,Card as t,CardContent as n,CardFooter as r,CardHeader as i,CardTitle as a,Form as o,FormControl as s,FormField as c,FormItem as l,FormLabel as u,FormMessage as d,Input as f,LoadingButton as p,PhoneInput as m,Spinner as h,__toESM as g,a as _,cn as v,formatPhone as y,instanceOfType as b,isValidPhoneNumber as x,objectType as S,require_jsx_runtime as C,require_react as w,stringType as T,toast as E,useBulkUpdateSettingsMutation as D,useForm as O,useGetSettingsQuery as k,useUpdateLogoMutation as A}from"./index-OmLcTgDE.js";import{SettingPageWrapper as j}from"./setting-page-wrapper-DsxRRjvs.js";var M=g(w()),N=g(C());const P=S({image:b(File).nullable()});function F(e){let t=e.target.files&&e.target.files[0],n=t?URL.createObjectURL(t):``;return{file:t,displayUrl:n}}function I({data:d}){let[m,{isLoading:h}]=A(),[g,_]=(0,M.useState)(null),y=O({defaultValues:{image:null}});async function b(e){await m({image:e.image}).unwrap(),E.success(`Changes saved`),y.reset()}return(0,M.useEffect)(()=>{d&&_(d.company_logo)},[d]),(0,N.jsxs)(t,{className:`max-w-xl`,children:[(0,N.jsx)(i,{children:(0,N.jsx)(a,{children:`Branding`})}),(0,N.jsx)(n,{children:(0,N.jsx)(o,{...y,children:(0,N.jsxs)(`form`,{onSubmit:y.handleSubmit(b),className:`space-y-6`,children:[(0,N.jsx)(c,{control:y.control,name:`image`,render:({field:{value:e,onChange:t,...n}})=>(0,N.jsxs)(l,{children:[(0,N.jsx)(u,{children:`Logo`}),(0,N.jsx)(s,{children:(0,N.jsx)(f,{...n,placeholder:`Image`,type:`file`,accept:`image/png, image/jpeg`,multiple:!1,onChange:e=>{let{file:n,displayUrl:r}=F(e);_(r),t(n)}})})]})}),(0,N.jsx)(`div`,{className:`flex justify-center items-center`,children:g&&(0,N.jsx)(`div`,{className:`relative size-40 p-1 rounded-md border-2 border-dashed`,children:(0,N.jsx)(`img`,{src:g,alt:`Company logo`,className:`h-full w-full rounded-md object-contain`})})})]})})}),(0,N.jsx)(r,{className:`justify-end border-t`,children:(0,N.jsxs)(`div`,{className:v(`flex transition-opacity gap-3 duration-500`,{"invisible opacity-0":!y.formState.isDirty,"visible opacity-100":y.formState.isDirty}),children:[(0,N.jsx)(e,{type:`button`,variant:`outline`,onClick:()=>{_(d?.company_logo||null),y.reset()},children:`Cancel`}),(0,N.jsx)(p,{type:`button`,disabled:h,loading:h,onClick:()=>{y.handleSubmit(b)()},children:`Save changes`})]})})]})}const L=S({company_name:T(),company_address:T(),company_phone:T().refine(e=>x(e,`US`),{message:`Invalid phone number`}),company_email:T().email(),company_website:T()});function R({data:h}){let[g,{isLoading:b}]=D(),x=O({resolver:_(L),defaultValues:{company_name:h.company_name??``,company_address:h.company_address??``,company_phone:h.company_phone??``,company_email:h.company_email??``,company_website:h.company_website??``}});async function S(e){let t=await g({data:e}).unwrap();t&&(E.success(`Changes saved`),x.reset({...t}))}return(0,N.jsxs)(t,{className:`max-w-xl`,children:[(0,N.jsx)(i,{children:(0,N.jsx)(a,{children:`Company Information`})}),(0,N.jsx)(n,{children:(0,N.jsx)(o,{...x,children:(0,N.jsxs)(`form`,{onSubmit:x.handleSubmit(S),className:`space-y-6`,children:[(0,N.jsx)(c,{control:x.control,name:`company_name`,render:({field:e})=>(0,N.jsxs)(l,{children:[(0,N.jsx)(u,{children:`Company name`}),(0,N.jsx)(s,{children:(0,N.jsx)(f,{...e,autoComplete:`off`})}),(0,N.jsx)(d,{})]})}),(0,N.jsx)(c,{control:x.control,name:`company_address`,render:({field:e})=>(0,N.jsxs)(l,{children:[(0,N.jsx)(u,{children:`Company address`}),(0,N.jsx)(s,{children:(0,N.jsx)(f,{...e,autoComplete:`off`})}),(0,N.jsx)(d,{})]})}),(0,N.jsx)(c,{control:x.control,name:`company_phone`,render:({field:e})=>(0,N.jsxs)(l,{children:[(0,N.jsx)(u,{children:`Company phone`}),(0,N.jsx)(s,{children:(0,N.jsx)(m,{...e,value:y(e.value??``),handleValueChange:e.onChange})}),(0,N.jsx)(d,{})]})}),(0,N.jsx)(c,{control:x.control,name:`company_email`,render:({field:e})=>(0,N.jsxs)(l,{children:[(0,N.jsx)(u,{children:`Company email`}),(0,N.jsx)(s,{children:(0,N.jsx)(f,{...e,autoComplete:`off`})}),(0,N.jsx)(d,{})]})}),(0,N.jsx)(c,{control:x.control,name:`company_website`,render:({field:e})=>(0,N.jsxs)(l,{children:[(0,N.jsx)(u,{children:`Company website`}),(0,N.jsx)(s,{children:(0,N.jsx)(f,{...e,autoComplete:`off`})}),(0,N.jsx)(d,{})]})})]})})}),(0,N.jsx)(r,{className:`justify-end border-t`,children:(0,N.jsxs)(`div`,{className:v(`flex transition-opacity gap-3 duration-500`,{"invisible opacity-0":!x.formState.isDirty,"visible opacity-100":x.formState.isDirty}),children:[(0,N.jsx)(e,{type:`button`,variant:`outline`,onClick:()=>x.reset(),children:`Cancel`}),(0,N.jsx)(p,{type:`button`,disabled:b,loading:b,onClick:()=>{x.handleSubmit(S)()},children:`Save changes`})]})})]})}function z(){let{data:e,isLoading:t}=k();return(0,N.jsx)(j,{children:t?(0,N.jsx)(`div`,{className:`flex h-96 max-w-xl items-center justify-center`,children:(0,N.jsx)(h,{})}):(0,N.jsxs)(`div`,{className:`space-y-4`,children:[(0,N.jsx)(R,{data:e}),(0,N.jsx)(I,{data:e})]})})}const B=z;export{B as Component};