import{H as g,r as d,j as e,S as C,k as S,B as u,l as k,m as v,n as T,o as b,p as N,q as y,L as h,t as x,h as p,T as F,I as w,J as L,g as I}from"./index-BrQi1v-c.js";import{C as _,a as A,b as E,f as P,d as q,e as B}from"./card-Cim6kUnN.js";import{S as M}from"./skeleton-CQuYJPyZ.js";import{S as H}from"./setting-page-wrapper-lwIfDS-L.js";import{u as O,F as U,a as D,b as V,c as z,d as G,e as J,f as Q,s as R,o as W,g as K}from"./zod-CKf-_hsS.js";import{I as j}from"./input-B52D2lzl.js";import{P as X}from"./plus-DlXTtDVQ.js";import{S as Y}from"./switch-BF-SWcQn.js";import"./label-CbHfFtVG.js";import"./index-CT2Pw8Do.js";const Z=W({name:K({required_error:"Name is required."}).min(1,{message:"Name must be at least 1 character long."})});function $(){const[r,{isLoading:c}]=g(),[l,i]=d.useState(!1),s=O({mode:"onChange",reValidateMode:"onChange",resolver:R(Z),defaultValues:{name:""}});function t(a){r(a).unwrap().then(()=>{x.success("Truck created"),s.reset(),i(!1)}).catch(n=>{p(n)})}return e.jsxs(C,{open:l,onOpenChange:i,children:[e.jsx(S,{asChild:!0,children:e.jsxs(u,{children:[e.jsx(X,{}),"Create truck"]})}),e.jsxs(k,{children:[e.jsxs(v,{children:[e.jsx(T,{children:"Add truck"}),e.jsx(b,{className:"sr-only"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:e.jsx(U,{...s,children:e.jsx("form",{onSubmit:s.handleSubmit(t),className:"space-y-6",children:e.jsx(D,{control:s.control,name:"name",render:({field:a})=>e.jsxs(V,{children:[e.jsx(z,{children:"Name (required)"}),e.jsx(G,{children:"Name of the truck for internal use."}),e.jsx(J,{children:e.jsx(j,{...a,autoComplete:"off"})}),e.jsx(Q,{})]})})})})}),e.jsxs(N,{children:[e.jsx(y,{asChild:!0,children:e.jsx(u,{type:"button",variant:"outline",className:"w-full",children:"Cancel"})}),e.jsx(h,{type:"button",loading:c,disabled:c,onClick:s.handleSubmit(t),className:"w-full",children:"Add truck"})]})]})]})}function ee({items:r,setItems:c,setIsTouched:l}){function i(s,t,a){const n=r.map(o=>o.id===s.id?{...o,[t]:a}:o);c(n),l(!0)}return e.jsx("div",{className:"space-y-4",children:r==null?void 0:r.map((s,t)=>e.jsxs("div",{className:"grid grid-cols-[6rem_3rem_1fr] gap-6 items-center",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsx(F,{className:"size-5"}),e.jsxs("span",{children:["Truck ",t+1]})]}),e.jsx(Y,{checked:s.is_active,onCheckedChange:a=>{i(s,"is_active",a)}}),e.jsx(j,{value:s.name,onChange:a=>{const n=a.target.value;i(s,"name",n)}})]},s.id))})}function se(){const{data:r,isLoading:c,isError:l}=w(),[i,{isLoading:s}]=L(),[t,a]=d.useState([]),[n,o]=d.useState(!1);return d.useEffect(()=>{r&&a(r)},[r]),e.jsx(H,{children:e.jsxs(_,{className:"max-w-xl",children:[e.jsxs(A,{children:[e.jsx(E,{children:"Trucks"}),e.jsx(P,{children:e.jsx($,{})})]}),e.jsxs(q,{children:[l&&e.jsx("div",{children:e.jsx("p",{className:"text-muted-foreground text-center",children:"Failed to fetch trucks"})}),c&&e.jsx("div",{className:"space-y-4",children:Array.from({length:3}).map((m,f)=>e.jsx(M,{className:"h-9 w-full"},f))}),r&&e.jsx(ee,{items:t,setItems:a,setIsTouched:o})]}),e.jsx(B,{className:"justify-end border-t",children:e.jsxs("div",{className:I("flex transition-opacity duration-500 gap-3",{"invisible opacity-0":!n,"visible opacity-100":n}),children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>{a(r??[]),o(!1)},children:"Cancel"}),e.jsx(h,{type:"button",disabled:s,loading:s,onClick:()=>{i({trucks:t}).unwrap().then(()=>{o(!1),x.success("Changes saved")}).catch(m=>{p(m)})},children:"Save changes"})]})})]})})}const me=se;export{me as Component};
