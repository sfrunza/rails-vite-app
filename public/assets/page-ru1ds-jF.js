import"./chevron-left-zJdJqyR0.js";import{PenLine as e}from"./pen-line-ChCzM0Ic.js";import{Button as t,Input as n,LoadingButton as r,ScrollArea as i,ScrollBar as a,Separator as o,Skeleton as s,__toESM as c,cn as l,formatCentsToDollarsString as u,handleApiError as d,hexToRgb as f,require_jsx_runtime as p,require_react as m,toast as h,useBulkUpdateRatesMutation as g,useGetRatesQuery as _}from"./index-BpPvn16n.js";import{Card as v,CardContent as y,CardFooter as b,CardHeader as x,CardTitle as S}from"./card-D6e0mOnd.js";import{Switch as C}from"./switch-TnSuzTX_.js";import{SettingPageWrapper as w}from"./setting-page-wrapper-B7I8Q1ot.js";import{NumericInput as T}from"./numeric-input-pQ8PfA2f.js";var E=c(m()),D=c(p());const O=`grid grid-cols-[2fr_1fr_1fr_1fr_1fr_1fr_1fr_1fr] items-center gap-4 px-1 text-sm font-medium`;function k(){let{data:s,isLoading:c}=_(),[p,{isLoading:m}]=g(),[k,A]=(0,E.useState)([]),[M,N]=(0,E.useState)(!1),[P,F]=(0,E.useState)(null);(0,E.useEffect)(()=>{s&&A(s)},[s]);function I(e){let t=k.map(t=>t.id===e.id?e:t);A(t),N(!0)}return(0,D.jsx)(w,{children:(0,D.jsxs)(v,{children:[(0,D.jsx)(x,{children:(0,D.jsx)(S,{children:`Rates`})}),(0,D.jsx)(y,{className:`space-y-6`,children:(0,D.jsxs)(i,{className:`w-full`,children:[(0,D.jsxs)(`div`,{className:l(`mb-4 text-muted-foreground`,O),children:[(0,D.jsx)(`p`,{children:`Name`}),(0,D.jsx)(`p`,{children:`2 movers`}),(0,D.jsx)(`p`,{children:`3 movers`}),(0,D.jsx)(`p`,{children:`4 movers`}),(0,D.jsx)(`p`,{children:`Extra mover`}),(0,D.jsx)(`p`,{children:`Extra truck`}),(0,D.jsx)(`p`,{children:`On/Off`}),(0,D.jsx)(`p`,{className:`sr-only`,children:`Actions`})]}),(0,D.jsx)(o,{}),(0,D.jsxs)(`div`,{className:`min-w-[900px] divide-y`,children:[c&&(0,D.jsx)(j,{}),k?.map((r,i)=>(0,D.jsxs)(`div`,{className:l(`py-4`,O),children:[P===i?(0,D.jsxs)(`div`,{className:`grid grid-cols-[auto_36px] gap-2`,children:[(0,D.jsx)(n,{name:`${r.name}-name`,value:r.name,onChange:e=>{I({...r,name:e.target.value})}}),(0,D.jsx)(n,{name:`${r.name}-color`,type:`color`,value:r.color,onChange:e=>{I({...r,color:e.target.value})},className:`px-[2px] py-0`})]}):(0,D.jsxs)(`span`,{className:`flex h-9 items-center gap-2 rounded-sm px-2 py-1`,style:{color:r.color,backgroundColor:`rgba(${f(r.color)}, 0.1)`},children:[r.name,(0,D.jsx)(`span`,{className:`h-2 w-2 rounded-full`,style:{backgroundColor:r.color}})]}),Object.keys(r.movers_rates).slice(0,3).map((e,t)=>{let n=r.movers_rates[e].hourly_rate;return P===i?(0,D.jsx)(T,{name:`${r.name}-${e}-${t}`,value:(n/100).toString(),min:0,max:1e4,onChange:t=>{I({...r,movers_rates:{...r.movers_rates,[e]:{...r.movers_rates[e],hourly_rate:Number(t)*100}}})}},t):(0,D.jsx)(`div`,{children:u(n)},t)}),(0,D.jsx)(`div`,{children:P===i?(0,D.jsx)(T,{name:`${r.name}-extra-mover`,value:(r.extra_mover_rate/100).toString(),min:0,max:1e4,onChange:e=>{I({...r,extra_mover_rate:Number(e)*100})}}):u(r.extra_mover_rate)}),(0,D.jsx)(`div`,{children:P===i?(0,D.jsx)(T,{name:`${r.name}-extra-truck`,value:(r.extra_truck_rate/100).toString(),min:0,max:1e4,onChange:e=>{I({...r,extra_truck_rate:Number(e)*100})}}):u(r.extra_truck_rate)}),(0,D.jsx)(C,{id:`${r.name}-enable`,checked:r.enable,disabled:i===0,onCheckedChange:e=>{I({...r,enable:e})}}),(0,D.jsx)(t,{variant:`outline`,size:`icon`,onClick:()=>{F(e=>e===i?null:i)},children:(0,D.jsx)(e,{})})]},i))]}),(0,D.jsx)(a,{orientation:`horizontal`})]})}),(0,D.jsx)(b,{className:`justify-end border-t`,children:(0,D.jsxs)(`div`,{className:l(`flex gap-3 transition-opacity duration-500`,{"invisible opacity-0":!M,"visible opacity-100":M}),children:[(0,D.jsx)(t,{type:`button`,variant:`outline`,onClick:()=>{A(s),N(!1),F(null)},children:`Cancel`}),(0,D.jsx)(r,{type:`button`,disabled:m,loading:m,onClick:()=>{p({rates:k}).unwrap().then(()=>{N(!1),F(null),h.success(`Changes saved`)}).catch(e=>{d(e)})},children:`Save changes`})]})})]})})}const A=k;function j(){return(0,D.jsx)(D.Fragment,{children:Array.from({length:5}).map((e,t)=>(0,D.jsxs)(`div`,{className:`grid grid-cols-[2fr_1fr_1fr_1fr_1fr_1fr_1fr_1fr] items-center gap-4 px-1 py-4`,children:[(0,D.jsx)(s,{className:`h-9 w-full`}),(0,D.jsx)(s,{className:`h-9 w-full`}),(0,D.jsx)(s,{className:`h-9 w-full`}),(0,D.jsx)(s,{className:`h-9 w-full`}),(0,D.jsx)(s,{className:`h-9 w-full`}),(0,D.jsx)(s,{className:`h-9 w-full`}),(0,D.jsx)(s,{className:`h-9 w-full`}),(0,D.jsx)(s,{className:`h-9 w-full`})]},t))})}export{A as Component};